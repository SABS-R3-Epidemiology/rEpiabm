<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R-Wrapper of Epiabm • rEpiabm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R-Wrapper of Epiabm">
<meta property="og:description" content="Wraps the epiabm Python module in R.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">rEpiabm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<p>ADD BADGES # rEpiabm rEpiabm enables users familiar with R to use <a href="https://github.com/SABS-R3-Epidemiology/epiabm" class="external-link">Epiabm</a>. Epiabm is a simulation tool that models the progress of an epidemic across a specified region of interest within a specific timeframe. It has been developed in python (PyEpiabm) for small-scale implementations and C++ (cEpiabm) for fast, large-scale simulations. PyEpiabm has a modular design, with many options to configure specific requirements.</p>
<div class="section level2">
<h2 id="summary-of-epiabm-functionality">Summary of Epiabm functionality<a class="anchor" aria-label="anchor" href="#summary-of-epiabm-functionality"></a>
</h2>
<div class="section level3">
<h3 id="basic-architecture">Basic Architecture<a class="anchor" aria-label="anchor" href="#basic-architecture"></a>
</h3>
<p>To model an epidemic, contact events occur within the population spatial structure (see Figure 1.). A compartmental model is used for the progression of the disease within-host (see Figure 2.). These two architectures are highly configurable which allows us to study a wide range of simulation scenarios.</p>
<div style="display: flex; gap: 20px;">
<div style="flex: 1;">
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="sc">&lt;</span>img src<span class="ot">=</span><span class="st">"./images/population_spatial_structure.png"</span> alt<span class="ot">=</span><span class="st">"Population spatial structure"</span> width<span class="ot">=</span><span class="st">"100%"</span><span class="sc">&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="er">&lt;</span>p<span class="sc">&gt;</span><span class="er">&lt;</span>figcaption<span class="sc">&gt;</span><span class="er">&lt;</span>i<span class="sc">&gt;</span><span class="er">&lt;</span>b<span class="sc">&gt;</span>Figure <span class="fl">1.</span><span class="sc">&lt;</span><span class="er">/</span>b<span class="sc">&gt;</span> Population Spatial Structure<span class="sc">:</span> The environment is modelled using <span class="sc">&lt;</span>a href<span class="ot">=</span><span class="st">"https://github.com/SABS-R3-Epidemiology/EpiGeoPop"</span><span class="sc">&gt;</span>EpiGeoPop<span class="sc">&lt;</span><span class="er">/</span>a<span class="sc">&gt;</span>, which takes a region of interest, creates layers of sub<span class="sc">-</span>regions of different types and populates these with individuals.<span class="sc">&lt;</span><span class="er">/</span>p<span class="sc">&gt;</span><span class="er">&lt;</span>figcaption<span class="sc">&gt;</span><span class="er">&lt;/</span>i<span class="sc">&gt;</span></span></code></pre></div>
</div>
<div style="flex: 1;">
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">&lt;</span>img src<span class="ot">=</span><span class="st">"./images/infection_progression.jpg"</span> alt<span class="ot">=</span><span class="st">"Infection progression"</span> width<span class="ot">=</span><span class="st">"100%"</span><span class="sc">&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="er">&lt;</span>p<span class="sc">&gt;</span><span class="er">&lt;</span>figcaption<span class="sc">&gt;</span><span class="er">&lt;</span>i<span class="sc">&gt;</span><span class="er">&lt;</span>b<span class="sc">&gt;</span>Figure <span class="fl">2.</span><span class="sc">&lt;</span><span class="er">/</span>b<span class="sc">&gt;</span> Infection Progression<span class="sc">:</span> The infection progression is represented using a <span class="sc">&lt;</span>a href<span class="ot">=</span><span class="st">"https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology"</span><span class="sc">&gt;</span>compartment model<span class="sc">&lt;</span><span class="er">/</span>a<span class="sc">&gt;</span> which tracks the daily progress of the disease within an individual.<span class="sc">&lt;</span><span class="er">/</span>i<span class="sc">&gt;</span><span class="er">&lt;</span>figcaption<span class="sc">&gt;</span><span class="er">&lt;/</span>p<span class="sc">&gt;</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="running-a-simulation">Running a simulation<a class="anchor" aria-label="anchor" href="#running-a-simulation"></a>
</h2>
<p>The basic flow of a simulation is described below; a more detailed, complex example is illustrated <a href="./walk_through/detailed_example.ipynb">in this Jupyter notebook</a>. We give instructions to run a basic simulation for both a toy population and a population extracted by <a href="https://github.com/SABS-R3-Epidemiology/EpiGeoPop" class="external-link">EpiGeoPop</a>, using ‘Andorra’ as an example of the region of interest. Also, <a href="https://github.com/SABS-R3-Epidemiology/epiabm/wiki/Overview-of-the-Ferguson-Model" class="external-link">the Wiki</a> details optional parameters available to the user as well as those whose values are mentioned, but changing them is not recommended.</p>
<div class="section level3">
<h3 id="step-1-set-up-repiabm">Step 1: Set up rEpiabm<a class="anchor" aria-label="anchor" href="#step-1-set-up-repiabm"></a>
</h3>
<p>Before running a simulation, rEpiabm needs to be installed with all dependencies mentioned in the DESCRIPTION file. Also, the input folder structure used by the R program file needs to be set up.</p>
<p><strong>Instructions:</strong> 1. Clone the Github rEpiabm repository 2. Create a GitHub Personal Access Token (fine-grained) 3. Configure RStudio with your token 4. Install required R packages <code>bash   install.packages("devtools")   devtools::install_github("SABS-R3-Epidemiology/rEpiabm")</code> 5. You now have two different simulation options:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fl">5.1</span> <span class="sc">*</span>An Epigeopop based simulation<span class="sc">*</span> </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>This uses <span class="sc">**</span>real<span class="sc">**</span> data to create the Population spatial structure<span class="sc">*</span><span class="er">:</span> Copy the example <span class="st">`</span><span class="at">Andorra</span><span class="st">`</span> folder structure within the data folder and name it with your region of interest. Include the <span class="st">`</span><span class="at">.json</span><span class="st">`</span> file as you will need to edit this later <span class="cf">for</span> your simulation.</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>OR</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fl">5.2</span> <span class="sc">*</span>A toy simulation<span class="sc">*</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>Users can specify population parameter <span class="fu">values</span> (usually small quantities) to create the Population spatial structure<span class="sc">*</span><span class="er">:</span> Copy the example <span class="st">`</span><span class="at">toy</span><span class="st">`</span> folder structure within the data folder and name it with your region of interest. Include the <span class="st">`</span><span class="at">.json</span><span class="st">`</span> file as you will need to edit this later <span class="cf">for</span> your simulation.<span class="sc">&lt;</span>br<span class="sc">&gt;</span><span class="er">&lt;</span>br<span class="sc">&gt;</span></span></code></pre></div>
<p>You are now ready to generate or configure the population for your simulation.</p>
</div>
<div class="section level3">
<h3 id="step-2-generate-the-population-spatial-structure">Step 2: Generate the population spatial structure<a class="anchor" aria-label="anchor" href="#step-2-generate-the-population-spatial-structure"></a>
</h3>
<p>As shown in Figure 1, the region of interest is broken into a spatial structure: * <em>Cells</em> - largest areas, based on a fixed width * <em>Microcells</em> - cells are split into microcells which contain smaller areas containing individuals * <em>Households</em> - quantity per microcell is based on a probabilistic distribution. All individuals are assigned to one household and do not move households during the simulation. * <em>Places</em> - quantity per microcell is based on a probabilistic distribution. These are spaces where individuals might meet other individuals from different households, a workplace or a public park for example.</p>
<p>[!Important] Follow <strong>Step 2.1</strong> instructions for an Epigeopop simulation or <strong>Step 2.2</strong> for a toy simulation.</p>
<p><strong>Step 2.1 Using EpiGeoPop</strong></p>
<p>The structure is created using <a href="https://github.com/SABS-R3-Epidemiology/EpiGeoPop" class="external-link">EpiGeoPop</a>. The user states a region of interest, Oxford or UK for example, and the tool extracts information from <a href="https://www.naturalearthdata.com/" class="external-link">Natural Earth</a> and <a href="https://data.jrc.ec.europa.eu/csv" class="external-link">JRC</a>, providing a csv file as output. This file contains one line per microcell for each cell, with the number of households, places and individuals to be used in the simulation (the quantity of individuals are extracted from Census data).</p>
<p><strong>Instructions:</strong></p>
<ol style="list-style-type: decimal">
<li>Go to <a href="https://github.com/SABS-R3-Epidemiology/EpiGeoPop" class="external-link">EpiGeoPop</a> repository and follow the instructions to extract a csv file of your required region.</li>
</ol>
<p><strong>NB:</strong> The json file which you amend to put the name your country also needs the proportion of households with 1 individual, 2 individuals, 3 individuals… upto 10 individuals. This information is usually found using census data (or equivalent) for your region. Amend the json file as described <a href="./walk_through/detailed_example.ipynb">in this Jupyter notebook</a>.</p>
<ol start="2" style="list-style-type: decimal">
<li>Copy the extracted file to the new folder data/<your_country>/inputs</your_country>
</li>
</ol>
<p><strong>NB:</strong> At the time of writing, the tool did not extract the data successfully. Please follow the instructions <a href="./walk_through/detailed_example.ipynb">in this Jupyter notebook</a>.</p>
<p>In summary, the spatial structure for a region is generated using EpiGeoPop. This tool exports into a csv file the number of households, places, and individuals for each microcell. It also produces a Population Density map in the <code>outputs/countries/&lt;your_country&gt;.pdf</code>, an example of Andorra shown in Figure 3.</p>
<figure><img src="./images/Andorra.png" alt="Population density map of Andorra"><figcaption><i>Figure 3. Example output: Population density map of Andorra.</i>
</figcaption></figure><p><strong>Step 2.2 Using User-defined values</strong></p>
<p>The user defines population values to generate a toy population spatial structure for the simulation. No region is specified but can be named to distinguish different simulation runs. This option is commonly used to <em>play</em> with different configurations of the simulation using small populations.</p>
<p><strong>Instructions:</strong></p>
<ol style="list-style-type: decimal">
<li>Open simulation.R and amend the following parameters (these are the default values):</li>
</ol>
<pre><code>population_size = as.integer(100),
cell_number = as.integer(2),
microcell_number = as.integer(2),
household_number = as.integer(5),
place_number = as.integer(2)
population_seed = as.integer(42)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Save simulation.R</li>
</ol>
</div>
<div class="section level3">
<h3 id="step-3-configure-the-simulation">Step 3: Configure the simulation<a class="anchor" aria-label="anchor" href="#step-3-configure-the-simulation"></a>
</h3>
<p>Once the data for your country has been extracted, the simulation can be configured and run. An overview of the program workflow is illustrated in Figure 4.</p>
<figure><img src="./images/program_workflow.png" alt="Overview of simulation workflow"><figcaption><i>Figure 4. Overview of simulation workflow: These steps are required to run a simulation.</i>
</figcaption></figure><p> </p>
<p>The following parameters are essential and need to be stated by the user to run a simulation:</p>
<ul>
<li>Name of the path to the csv file from EpiGeoPop</li>
<li>Number of infected individuals (Imild): enter the number of infected individuals at the start of the simulation.</li>
<li>Proportion of households with 1 individual, 2 individuals, 3 individuals… upto 10 individuals. This information is usually found using census data (or equivalent) for your country.</li>
<li>Time for the simulation to run (in days)</li>
<li>Select any output options required</li>
</ul>
<p><strong>Instructions:</strong> 1. Open your version of <em>Andorra_parameters.json</em> (copied from <code>Andorra</code> in Step 1 above) and save with <em><your_country></your_country></em>’s name (keep first letter capitalised). 2. Amend the parameter array household_size_distribution to have your countries’ distribution used in step 2. 3. Open <code>simulation_epigeopop.R</code> and amend: * <code>input_dir</code>: the absolute path to your csv file exported from EpiGeoPop * <code>initial_infected</code>: enter the number of infected individuals at the start of the simulation. * ``: enter the time for the simulation to run (in days) * <code>Andorra</code> in final line: change to <em><your_country></your_country></em>.</p>
<p>More detailed instructions are available <a href="./walk_through/detailed_example.ipynb">in this Jupyter notebook</a> and further optional parameters are described in <a href="https://github.com/SABS-R3-Epidemiology/epiabm/wiki/Overview-of-the-Ferguson-Model" class="external-link">the Wiki</a></p>
<p><strong>Common adjustments:</strong> * At the start, infected individuals are distributed across all cells by default, you may want to put them in one cell. * Maximum infection radius: this sets a maximum distance for the infection to be able to spread from cell to cell * Age distribution used is required * Outputs to evaluate simulation (see Step 5: Evaluate Results)</p>
</div>
<div class="section level3">
<h3 id="step-4-run-the-simulation">Step 4: Run the simulation<a class="anchor" aria-label="anchor" href="#step-4-run-the-simulation"></a>
</h3>
<p>Once configured, the simulation takes the generated population and performs the following ‘sweeps’:</p>
<p><strong>Initialisation sweeps:</strong> * InitialHouseholdSweep - Assign individuals to households * InitialisePlaceSweep - Assign individuals to places * InitialInfectedSweep - Assign which individuals are initially infected</p>
<p>There are optional modules such as recording demographics, which are described in <a href="https://github.com/SABS-R3-Epidemiology/epiabm/wiki/Overview-of-the-Ferguson-Model" class="external-link">the Wiki</a></p>
<p><strong>Simulation sweeps:</strong></p>
<p>Individual’s location and infection status is updated each day: * UpdatePlaceSweep - Account for movement of individuals by refreshing their ‘place’ assignments * Check each infected individual to see if they infect others: * HouseholdSweep - At a household * PlaceSweep - At a place * SpatialSweep - Between cells * QueueSweep - Any successful infections will update the newly infected person’s status from S (Susceptible) to E (Exposed). * HostProgressionSweep - Individual’s Infection progress is updated using the compartmental model</p>
<p><strong>Instructions:</strong> 1. After saving the configured file, either <code>simulation_epigeopop.R</code> or <code>simulation_toy.R</code>, run this code!</p>
</div>
<div class="section level3">
<h3 id="step-5-evaluate-results">Step 5: Evaluate results<a class="anchor" aria-label="anchor" href="#step-5-evaluate-results"></a>
</h3>
<p>A simulation produces one csv output file by default, found in the directory <code>data/&lt;your_country&gt;/simulation_outputs</code>. This file contains the number of individuals for each infection status (S, E, I<sub>mild</sub>, etc) for each day.</p>
<p>It also produces a SI<sub>mild</sub>RD plot, which shows the overall progression of each status for the duration of the simulation.</p>
<p>Further optional files are available, details described in <a href="https://github.com/SABS-R3-Epidemiology/epiabm/wiki/Overview-of-the-Ferguson-Model" class="external-link">the Wiki</a> or see <a href="./walk_through/detailed_example.ipynb">this Jupyter notebook</a> with a detailed illustration here . These data files can be used to produce plots for further analysis.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://opensource.org/licenses/BSD-3-Clause" class="external-link">BSD_3_clause</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rEpiabm</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Anita Applegarth <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
<li>Kingsley Oguma <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Anita Applegarth, Kingsley Oguma.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
